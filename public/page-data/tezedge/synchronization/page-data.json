{"componentChunkName":"component---src-templates-post-template-js","path":"/tezedge/synchronization","result":{"data":{"markdownRemark":{"fields":{"slug":"/tezedge/synchronization"},"id":"d8cd6ff7-499b-5381-bad7-503fef3a6419","html":"<h1 id=\"the-synchronization-and-bootstrapping-process\" style=\"position:relative;\"><a href=\"#the-synchronization-and-bootstrapping-process\" aria-label=\"the synchronization and bootstrapping process permalink\" class=\"post-toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The synchronization and bootstrapping process</h1>\n<p>In this section, we explain the node synchronization process. We will particularly focus on the application of transactions (and other operations) to the Tezos protocol. Also included is a guide on how to run the TezEdge node’s synchronization process.</p>\n<p>Please note that the TezEdge node is currently capable of:</p>\n<ul>\n<li>Downloading headers and operations, which it can apply to the protocol in order to get the current state of the blockchain after the application of the most recent block.</li>\n<li>Creating an OCaml node-compatible database</li>\n<li>Providing web socket data for monitoring the synchronization process</li>\n<li>\n<p>Providing the following remote procedure calls (RPCs):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">/monitor/bootstrapped (GET)\n/chains/main/blocks/head (GET)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n</li>\n</ul>\n<h1 id=\"synchronization\" style=\"position:relative;\"><a href=\"#synchronization\" aria-label=\"synchronization permalink\" class=\"post-toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Synchronization</h1>\n<p>In Tezos, synchronization describes the process of a node downloading operations and headers from her peer(s) and then applying the operations to the protocol.</p>\n<p>The protocol is a set of rules that processes operations with the previous state of the blockchain, resulting in the next state. The protocol keeps processing operations and states until it reaches the latest block of operations, resulting in the latest state.</p>\n<p><img src=\"../../static/images/synchronization_1.gif\" alt=\"Image\" title=\"Applying a valid operation\"></p>\n<p>In Tezos, the latest state is sometimes referred to as the context. We will provide a more detailed explanation of state in a future article.</p>\n<p><strong>The synchronization process</strong></p>\n<p>Let’s say Alice wants to bake. To become a baker, Alice must synchronize her node with the network. In order to do so, Alice’s node must have her own copy of the blockchain. She acquires it by downloading the block headers and blocks of operations from her peer(s), applying them to the protocol until she reaches the latest block, resulting in the latest state of the blockchain.</p>\n<p><strong>1) Downloading headers and operations</strong></p>\n<p>To download operations and headers, Alice must establish a trusted connection with one of her peers. First, she requests and downloads the block headers. Second, her node will download all of the operations in the history of the network, starting with the oldest block of operations and progressing chronologically to the latest. We provided a detailed description of this process in our article about the P2P layer.</p>\n<p><strong>2) Applying to protocol</strong></p>\n<p>After Alice has downloaded all of the blocks of operations from her peers, her node will begin applying the operations to the protocol, starting with the oldest block of operations and progressing chronologically towards the latest. Each time a block of operations is applied, the state of the network is changed, directly affecting the balances of all Tezos accounts, among other values. Additionally, each time a block of operations is applied to the protocol, Alice creates a new context hash for the block. Alice continuously checks the correctness of her application process by comparing her context hash with the context hash from the block header.</p>\n<p>Some operations may be invalidated by the protocol. For instance, in the animation below, there is a transaction in which Alice sends 20 Tezos to Bob. However, the protocol checks the latest state, which reveals that Alice does not have enough in her balance to make the transaction, and thus the protocol invalidates the transaction.</p>\n<p><img src=\"../../static/images/synchronization_2.gif\" alt=\"Image\" title=\"Attempting to apply an invalid operation\"></p>\n<p>The synchronization process can be susceptible to errors and interruptions. In our approach to the synchronization process, our primary goal is to improve stability as much as possible. We applied various methods of improving network resiliency to common errors such as incorrect data, network timeouts, downtime and other network issues in general.</p>\n<p>When we download the blockchain data, we don’t interact with OCaml until we begin applying the blocks to the Tezos protocol. The results are cached into the RocksDB database that is embedded in the TezEdge node.</p>\n<p>The synchronization process can now be viewed through an early version of the web-based Node Explorer, which displays how many blocks have been downloaded. You can also see messages about statistics, including download speed and estimated time of download. These are delivered through a web socket.</p>\n<h1 id=\"guide-for-bootstrapping-the-tezedge-node\" style=\"position:relative;\"><a href=\"#guide-for-bootstrapping-the-tezedge-node\" aria-label=\"guide for bootstrapping the tezedge node permalink\" class=\"post-toc-anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Guide for bootstrapping the TezEdge node</h1>\n<p>You have three options for trying out the synchronization process:\n<strong>A) View an already running node through the Tezos Node Explorer (browser)</strong></p>\n<p>The most straightforward method is to view it through your internet browser at this address: node.tezedge.com\nSince this is a demo mode, you do not need to run your own node as it is already running. The node is regularly restarted in order to demonstrate the synchronization process.</p>\n<p><img src=\"../../static/images/synchronization_3.gif\" alt=\"Image\" title=\"Demo of the node&#x27;s bootstrapping process\"></p>\n<p><strong>B) Bootstrap your own node via Docker</strong></p>\n<ol>\n<li>\n<p>Download the repo</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">git clone https://github.com/simplestaking/tezedge</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>Download and install Docker (if you haven’t already)</li>\n<li>\n<p>Run docker by typing the following command into the terminal:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">cd docker\ndocker-composer up</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Your terminal will now show information about the bootstrapping process</p>\n</li>\n<li>You can also view this information in your browser by entering this address into the URL bar: <a href=\"http://127.0.0.1:8080/\">http://127.0.0.1:8080/</a></li>\n</ol>\n<p><strong>C) Build and run your node from the source code</strong></p>\n<p>You can build and run the node in multiple configurations. For instance, the node can provide structured logs, which makes it easier to set up various monitoring tools. For more information on how to build the node from the source code, see the readme on <a href=\"https://github.com/simplestaking/tezedge\">GitHub.</a></p>","frontmatter":{"date":null,"title":"Synchronization","sidebar":"Docs","showTitle":false,"hideAnchor":null}}},"pageContext":{}}}